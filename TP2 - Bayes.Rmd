---
title: |
  \vspace{1cm}
  \begin{tabular}{c}
  {\normalsize\textbf{UNIVERSIDAD NACIONAL DE ROSARIO}}\\
  {\Large Facultad de Ciencias Económicas y Estadística}\\
  \\
  \includegraphics[width=5cm]{LogoUNR.png}\\
  \vspace{1cm}
  \\
  {\huge\textbf{"Metropolis-Hastings"}}\\
  {\Large Estadística Bayesiana - Trabajo Práctico Nº2}\\
  \end{tabular}
  \vspace{5cm}
author: |
  *Alumnas:* Agustina Mac Kay, Ailén Salas y Rocio Canteros
date: "Año 2024"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
#Punto 1:
sample_mh <- function(d_objetivo, r_propuesta, d_propuesta, p_inicial, n) {
  muestras <- matrix(nrow = n, ncol = length(p_inicial))
  muestras[1, ] <- p_inicial
  
  for(i in 2:n) {
    p_actual <- muestras[i-1,]
    p_nuevo <- r_propuesta(p_actual)
    
    f_nuevo <- d_objetivo(p_nuevo)
    f_actual <- d_objetivo(p_actual)
    
    q_actual <- d_propuesta(p_actual, mean = p_nuevo)
    q_nuevo <- d_propuesta(p_nuevo, mean = p_actual)
    
    alpha <- min(1, (f_nuevo/f_actual)*(q_actual/q_nuevo))
    aceptar <- rbinom(1, 1, alpha)
    
    if(aceptar) { 
      muestras[i,] <- p_nuevo
    } else {
      muestras[i,] <- p_actual
    }
  }
  
  if (ncol(muestras) == 1) {
    muestras <- as.vector(muestras)
  } 
  return(muestras)
}

```



```{r}
#Punto 2
# Crear grilla para los valores de "x"
grid_n <- 200
x_grid <- seq(0, 1, length.out = grid_n)

kumaraswamy <- function(x, a, b){
  a*b*(x^(a-1))*((1-(x^a))^(b-1))
}

a <- c(0.2, 3, 4, 10, 1)
b <- c(0.2, 3, 9, 5, 7)

#Creamos un data frame para graficar la distribución de Kumaraswamy:

data1 <- data.frame(
  Funcion = rep(1:5, each = grid_n),
  Densidad = numeric(5 * grid_n),
  Grilla = rep(x_grid, times = 5)
) 

#Completamos el data frame con las densidades:
for(i in 1:5) {
    indices <- seq(from = 1 + (i - 1) * 200, to = 200 + (i - 1) * 200)
    data1$Densidad[indices] <- kumaraswamy(x_grid, a[i], b[i])

}

library(ggplot2)
ggplot(data = data1, aes(x = Grilla, y = Densidad)) +
  geom_line() +
  facet_wrap(~Funcion)



```


```{r}
#Punto 3

#Funciones a usar
d_objetivo <- function(x) kumaraswamy(x, 6, 2)
d_propuesta <- function(x, mean) dbeta(x, shape1 = mean * 4, shape2 = (1-mean) * 4)
r_propuesta <- function(x) rbeta(1, shape1 = x * 4, shape2 = (1-x) * 4)
#Donde x hace referencia a mu

sample_mh(d_objetivo, r_propuesta, d_propuesta, 0.5, 200)
```